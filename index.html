<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Locate the City üåç Quiz (Offline-ready)</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body {
      font-family: system-ui, sans-serif;
      text-align: center;
      background: #f5f5f5;
      margin: 0;
    }
    h1 {
      background: #2196f3;
      color: white;
      padding: 10px;
      margin: 0;
    }
    #map {
      height: 70vh;
      width: 95%;
      margin: 10px auto;
      border-radius: 10px;
    }
    input, button {
      padding: 10px;
      font-size: 1em;
      border-radius: 5px;
      margin: 5px;
    }
    button {
      background: #2196f3;
      color: white;
      border: none;
      cursor: pointer;
    }
    #errorMsg {
      color: red;
      font-weight: bold;
      margin-top: 8px;
    }
    #scoreBox {
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Locate the City üåç</h1>

  <div>
    <input type="text" id="countryInput" placeholder="Enter a country (India, USA, UK, France)" />
    <button id="startBtn">Start Quiz</button>
    <div id="errorMsg"></div>
  </div>

  <div id="map"></div>
  <div id="scoreBox">Score: <span id="score">0</span> / 10</div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const map = L.map("map").setView([20, 0], 2);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "&copy; OpenStreetMap contributors",
    }).addTo(map);

    const cityData = {
      india: [
        { name: "Delhi", lat: 28.6139, lon: 77.2090 },
        { name: "Mumbai", lat: 19.0760, lon: 72.8777 },
        { name: "Chennai", lat: 13.0827, lon: 80.2707 },
        { name: "Kolkata", lat: 22.5726, lon: 88.3639 },
        { name: "Bengaluru", lat: 12.9716, lon: 77.5946 },
        { name: "Hyderabad", lat: 17.3850, lon: 78.4867 },
        { name: "Pune", lat: 18.5204, lon: 73.8567 },
        { name: "Jaipur", lat: 26.9124, lon: 75.7873 },
        { name: "Ahmedabad", lat: 23.0225, lon: 72.5714 },
        { name: "Lucknow", lat: 26.8467, lon: 80.9462 }
      ],
      usa: [
        { name: "New York", lat: 40.7128, lon: -74.0060 },
        { name: "Los Angeles", lat: 34.0522, lon: -118.2437 },
        { name: "Chicago", lat: 41.8781, lon: -87.6298 },
        { name: "Houston", lat: 29.7604, lon: -95.3698 },
        { name: "Miami", lat: 25.7617, lon: -80.1918 },
        { name: "Dallas", lat: 32.7767, lon: -96.7970 },
        { name: "Seattle", lat: 47.6062, lon: -122.3321 },
        { name: "San Francisco", lat: 37.7749, lon: -122.4194 },
        { name: "Denver", lat: 39.7392, lon: -104.9903 },
        { name: "Boston", lat: 42.3601, lon: -71.0589 }
      ],
      uk: [
        { name: "London", lat: 51.5074, lon: -0.1278 },
        { name: "Manchester", lat: 53.4808, lon: -2.2426 },
        { name: "Birmingham", lat: 52.4862, lon: -1.8904 },
        { name: "Liverpool", lat: 53.4084, lon: -2.9916 },
        { name: "Leeds", lat: 53.8008, lon: -1.5491 },
        { name: "Glasgow", lat: 55.8642, lon: -4.2518 },
        { name: "Edinburgh", lat: 55.9533, lon: -3.1883 },
        { name: "Cardiff", lat: 51.4816, lon: -3.1791 },
        { name: "Bristol", lat: 51.4545, lon: -2.5879 },
        { name: "Sheffield", lat: 53.3811, lon: -1.4701 }
      ],
      france: [
        { name: "Paris", lat: 48.8566, lon: 2.3522 },
        { name: "Marseille", lat: 43.2965, lon: 5.3698 },
        { name: "Lyon", lat: 45.7640, lon: 4.8357 },
        { name: "Toulouse", lat: 43.6047, lon: 1.4442 },
        { name: "Nice", lat: 43.7102, lon: 7.2620 },
        { name: "Nantes", lat: 47.2184, lon: -1.5536 },
        { name: "Strasbourg", lat: 48.5734, lon: 7.7521 },
        { name: "Bordeaux", lat: 44.8378, lon: -0.5792 },
        { name: "Lille", lat: 50.6292, lon: 3.0573 },
        { name: "Montpellier", lat: 43.6108, lon: 3.8767 }
      ]
    };

    let currentCountry = [];
    let score = 0;
    let index = 0;
    let marker;

    document.getElementById("startBtn").addEventListener("click", () => {
      const country = document.getElementById("countryInput").value.trim().toLowerCase();
      const errorMsg = document.getElementById("errorMsg");
      errorMsg.textContent = "";

      if (!cityData[country]) {
        errorMsg.textContent = "‚ö†Ô∏è Sorry, that country is not available.";
        return;
      }

      currentCountry = cityData[country].sort(() => 0.5 - Math.random());
      score = 0;
      index = 0;
      document.getElementById("score").textContent = score;
      alert("Locate: " + currentCountry[index].name);
      map.setView([currentCountry[index].lat, currentCountry[index].lon], 4);

      if (marker) map.removeLayer(marker);
      marker = null;

      map.once("click", (e) => checkAnswer(e.latlng));
    });

    function checkAnswer(userLatLng) {
      const city = currentCountry[index];
      const distance = map.distance(userLatLng, [city.lat, city.lon]) / 1000;

      if (distance < 50) {
        alert(`‚úÖ Correct! Within ${distance.toFixed(1)} km`);
        score++;
      } else {
        alert(`‚ùå Wrong! You were ${distance.toFixed(1)} km away.`);
      }

      document.getElementById("score").textContent = score;

      if (marker) map.removeLayer(marker);
      marker = L.marker([city.lat, city.lon])
        .addTo(map)
        .bindPopup(city.name)
        .openPopup();

      index++;
      if (index < currentCountry.length) {
        setTimeout(() => {
          alert("Locate: " + currentCountry[index].name);
          map.setView([currentCountry[index].lat, currentCountry[index].lon], 4);
          map.once("click", (e) => checkAnswer(e.latlng));
        }, 1200);
      } else {
        alert(`üèÅ Quiz Over! Your final score: ${score}/${currentCountry.length}`);
      }
    }
  </script>
</body>
</html>
